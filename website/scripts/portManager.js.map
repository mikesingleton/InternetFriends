{"version":3,"sources":["portManager.js"],"names":["_portManagers","portManager","source","messageCallback","disconnectCallback","_this","_tabId","_source","_roomCode","_messageListener","_disconnectListener","init","push","this","_backgroundPortManager","processTabPortConnected","Logger","log","postMessage","message","disconnect","tell","event","data"],"mappings":"AAAA,YAEAA,iBAEA,IAAIC,aAAc,SAAqBC,EAAQC,EAAiBC,GAE9D,GAAIC,MACAC,EAAS,EACTC,EAAU,GACVC,EAAY,yBAEZC,EAAmB,KACnBC,EAAsB,IA0C1B,OAvCAL,GAAMH,OAAS,GAEfG,EAAMM,KAAO,SAAUT,EAAQC,EAAiBC,GAC9CG,EAAU,mBAAqBL,EAC/BG,EAAMH,OAASK,EACfE,EAAmBN,EACnBO,EAAsBN,EAEtBJ,cAAcY,KAAKC,MAEfC,wBAAwBA,uBAAuBC,wBAAwBF,MAE3EG,OAAOC,IAAI,mBAAoBf,IAIjCG,EAAMa,YAAc,SAAUC,GAC5BH,OAAOC,IAAIE,GACPV,GAAkBA,EAAiBU,IAGzCd,EAAMe,WAAa,WACbV,GAAqBA,KAG3BL,EAAMgB,KAAO,SAAUC,EAAOC,GAC5B,GAAIA,GAAOA,KAEmB,OAA1BT,wBACFA,uBAAuBI,aACrBI,MAAOA,EACPC,KAAMA,GACLjB,EAAQC,EAASC,IAKxBH,EAAMM,KAAKT,EAAQC,EAAiBC,GAE7BC","file":"portManager.js","sourcesContent":["\"use strict\";\n\n_portManagers = [];\n\nvar portManager = function portManager(source, messageCallback, disconnectCallback) {\n  // variables ----------------------------------------------------------------\n  var _this = {},\n      _tabId = 1,\n      _source = \"\",\n      _roomCode = \"internetfriendswebsite\",\n      _port = null,\n      _messageListener = null,\n      _disconnectListener = null,\n      _disconnectTimer = -1;\n\n  _this.source = \"\"; // initialize ---------------------------------------------------------------\n\n  _this.init = function (source, messageCallback, disconnectCallback) {\n    _source = \"InternetFriends-\" + source;\n    _this.source = _source;\n    _messageListener = messageCallback;\n    _disconnectListener = disconnectCallback;\n\n    _portManagers.push(this);\n\n    if (_backgroundPortManager) _backgroundPortManager.processTabPortConnected(this); // receive messages from \"background.js\"\n\n    Logger.log('portManager init', source);\n  }; // public functions ---------------------------------------------------------\n\n\n  _this.postMessage = function (message) {\n    Logger.log(message);\n    if (_messageListener) _messageListener(message);\n  };\n\n  _this.disconnect = function () {\n    if (_disconnectListener) _disconnectListener();\n  };\n\n  _this.tell = function (event, data) {\n    var data = data || {};\n\n    if (_backgroundPortManager != null) {\n      _backgroundPortManager.postMessage({\n        event: event,\n        data: data\n      }, _tabId, _source, _roomCode);\n    }\n  }; // messages -----------------------------------------------------------------\t\n\n\n  _this.init(source, messageCallback, disconnectCallback);\n\n  return _this;\n};"]}