"use strict";var Inject=function(){function e(e){if(v[e])return v[e];var n=chrome&&chrome.extension?chrome.extension.getURL("html/iframe/"+e+".html?view="+e+"&_"+(new Date).getTime()):"./html/iframe/chat.html",t=$("<iframe />",{id:m.IFRAME_PREFIX+e,src:n,scrolling:!1});return Logger.log(n,t),v[e]={isLoaded:!1,iframe:t},g.append(t),v[e]}function n(e){switch(Logger.log(e),e.event){case"loaded":i()}}function t(){Logger.log("disconnected"),e("chat",g).iframe.remove(),g.remove(),document.removeEventListener("scroll",r,!1),document.removeEventListener("mousemove",d,!1),document.removeEventListener("mouseleave",c,!1),document.removeEventListener("keydown",l,!1),document.removeEventListener("keyup",s,!1),document.removeEventListener("webkitvisibilitychange",a,!1),document.removeEventListener("msvisibilitychange",a,!1),w=null}function o(){return document.hidden||document.msHidden||document.webkitHidden}function i(){var e={scrollX:window.scrollX,scrollY:window.scrollY};w&&w.tell("scroll",e)}function r(){var e={scrollX:window.scrollX,scrollY:window.scrollY};w.tell("scroll",e)}function d(e){var n={x:e.pageX,y:e.pageY};w.tell("mousemove",n)}function c(e){w.tell("mouseleave")}function l(e){var n=e.which||e.keyCode;13===n&&document.activeElement==document.body&&(f=!0,e.preventDefault())}function s(e){var n=e.which||e.keyCode;13===n&&f&&(Logger.log("hey"),w.tell("enterpressed"),f=!1,e.preventDefault())}function a(e){o()?w.tell("pageHidden"):w.tell("pageVisible")}var m={CONTAINER:"internetFriends-container",IFRAME_PREFIX:"internetFriends-iframe-"},u={},v={},g=null,w=null,f=!1;return u.init=function(){g=$("<div />",{id:m.CONTAINER}),g.appendTo(document.body),e("chat",g),w=new portManager("main",n,t),w.tell("tabInit"),document.addEventListener("scroll",r,!1),document.addEventListener("mousemove",d,!1),document.addEventListener("mouseleave",c,!1),document.addEventListener("keydown",l,!1),document.addEventListener("keyup",s,!1),document.addEventListener("webkitvisibilitychange",a,!1),document.addEventListener("msvisibilitychange",a,!1)},u}(),isWebRTCSupported=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||window.RTCPeerConnection;isWebRTCSupported?document.addEventListener("DOMContentLoaded",function(){Inject.init()},!1):Logger.log("InternetFriends does not work without WebRTC support!");
//# sourceMappingURL=inject.js.map
